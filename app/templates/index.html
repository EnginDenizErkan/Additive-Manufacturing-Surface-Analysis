<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Welcome Page</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <style>
        html, body {
            height: 100%;
        }

        body {
            font-family: 'Inter', sans-serif;
            overflow-y: auto;     /* ✅ allow vertical scroll */
            overflow-x: hidden;   /* ✅ prevent horizontal scroll */
            -webkit-overflow-scrolling: touch; /* ✅ smoother scroll on iOS */
            color: #1f2937;
        }

        #landing-container {
            width: 100%;
            height: 300px;
            max-width: 500px;
            margin: 2rem auto;
            border-radius: 0.5rem;
            overflow: hidden;
            cursor: grab;
            opacity: 0;
            /* Start hidden for animation */
        }

        #landing-container:active {
            cursor: grabbing;
        }

        /* --- MODAL STYLES (UPDATED) --- */
        /* --- NEW: Common class for all overlays --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            /* Darker overlay for light mode */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s;
            /* Added padding for mobile scroll */
            padding: 1rem;
            overflow-y: auto;
        }

        .modal-overlay.modal-open {
            opacity: 1;
            visibility: visible;
        }

        /* --- NEW: Common class for all modal boxes --- */
        .modal-box {
            /* --- CHANGE: Light background for modal --- */
            background-color: #ffffff;
            color: #1f2937;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
            transform: scale(0.9);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            max-height: 90vh; /* Allow scrolling within box if content is tall */
            overflow-y: auto;
        }

        .modal-overlay.modal-open .modal-box {
            transform: scale(1);
            opacity: 1;
        }
        
        /* --- NEW: Common class for all close buttons --- */
        .modal-close-btn {
             margin-top: 1.5rem; /* Common margin */
        }

        /* --- NEW: Page Load Animations --- */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Apply animations with delays */
        #landing-page .logo-img {
            animation: fadeInDown 1s ease-out forwards;
            opacity: 0;
        }
        #landing-page h1 {
            animation: fadeInDown 1s ease-out 0.2s forwards;
            opacity: 0;
        }
        #landing-page .description-text {
            animation: fadeInDown 1s ease-out 0.4s forwards;
            opacity: 0;
        }
        #landing-container {
            animation: zoomIn 1s ease-out 0.6s forwards;
        }
        #landing-page .button-group {
            animation: fadeInUp 1s ease-out 0.8s forwards;
            opacity: 0;
        }

        /* --- NEW: 3D Text Effect --- */
        .text-3d {
            /* --- CHANGE: Shadows adjusted for light background --- */
            text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.1),
                         2px 2px 0px rgba(0, 0, 0, 0.1),
                         3px 3px 0px rgba(0, 0, 0, 0.1),
                         4px 4px 2px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body class="bg-gray-100">

    <div id="modal-info" class="modal-overlay">
        <div class="modal-box w-full max-w-md">
            <p id="modal-message" class="mb-4 text-lg">This website presents a data-driven framework for predicting surface roughness (Ra) in FDM additive manufacturing before printing. After you upload an STL model, the system automatically measures surface inclination angles from the geometry, then combines these angles with selected printing parameters to estimate Ra. Results are visualized on the 3D mesh using a colormap, and the platform also provides access to the collected measurement dataset so users can compare predictions with real measurements and review outcomes across different settings to support informed parameter selection and reduce trial-and-error.
</p>
            <button
                class="modal-close-btn px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition transform hover:scale-105">
                Close
            </button>
        </div>
    </div>

    <div id="modal-who" class="modal-overlay">
        <div class="modal-box w-full max-w-5xl"> <h2 class="text-3xl font-bold mb-4 text-gray-800">Who We Are?</h2>
            <p class="mb-8 text-lg text-gray-600">
                We are a research team from Middle East Technical University (METU), working on surface roughness prediction for 3D printed objects. Our work focuses on surface roughness prediction for 3D printed objects, using machine learning and data analysis to enhance 3D printing efficiency and quality in various industrial applications.
            </p>

            <div class="flex flex-col md:flex-row justify-around space-y-8 md:space-y-0 md:space-x-4 text-center">

                <div class="flex flex-col items-center">
                    <img src="static/engin_erkan.png" alt="Engin Deniz Erkan"
                        class="w-32 h-32 rounded-full mb-3 object-cover shadow-lg border-2 border-white">
                    <h3 class="text-xl font-semibold text-gray-800">ENGİN DENİZ ERKAN</h3>
                    <p class="text-gray-500 mb-3">MSc Student</p>
                    <div class="flex space-x-2">
                        <a href="https://www.linkedin.com/in/engindenizerkan/" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/linkedin-%230077B5.svg?&style=for-the-badge&logo=linkedin&logoColor=white" alt="LinkedIn"></a>
                        <a href="https://github.com/EnginDenizErkan" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/github-%23181717.svg?&style=for-the-badge&logo=github&logoColor=white" alt="GitHub"></a>
                    </div>
                </div>

                <div class="flex flex-col items-center">
                    <img src="static/elif_surer.png" alt="Elif Sürer"
                        class="w-32 h-32 rounded-full mb-3 object-cover shadow-lg border-2 border-white">
                    <h3 class="text-xl font-semibold text-gray-800">ELİF SÜRER</h3>
                    <p class="text-gray-500 mb-3">Assoc. Prof.</p>
                    <a href="https://avesis.metu.edu.tr/elifs" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/avesis-%230077B5.svg?&style=for-the-badge&logo=microsoft-academic&logoColor=white" alt="Avesis"></a>
                </div>

                <div class="flex flex-col items-center">
                    <img src="static/ulas_yaman.png" alt="Ulaş Yaman"
                        class="w-32 h-32 rounded-full mb-3 object-cover shadow-lg border-2 border-white">
                    <h3 class="text-xl font-semibold text-gray-800">ULAŞ YAMAN</h3>
                    <p class="text-gray-500 mb-3">Prof. Dr.</p>
                    <a href="https://avesis.metu.edu.tr/uyaman" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/avesis-%230077B5.svg?&style=for-the-badge&logo=microsoft-academic&logoColor=white" alt="Avesis"></a>
                </div>
            </div>

            <button
                class="modal-close-btn px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition transform hover:scale-105">
                Close
            </button>
        </div>
    </div>

    <div id="landing-page" class="flex flex-col items-center justify-center min-h-screen p-8">

        <img src="static/logo.png" alt="Logo" class="w-24 h-24 mb-4 logo-img">

        <h1 class="text-6xl font-bold text-blue-600 mb-4 text-3d">
            Surface Roughness Prediction
        </h1>

        <h1 class="text-6xl font-bold text-blue-600 mb-4 text-3d">
            of 3D Printed Objects
        </h1>

        <p class="text-xl text-gray-500 mb-8 description-text">Welcome to the interactive viewer</p>

        <div id="landing-container"></div>

        <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4 mt-6 button-group">
            <button id="btn-load"
                class="px-6 py-3 bg-blue-600 text-white text-lg font-semibold rounded-lg hover:bg-blue-700 transition shadow-lg transform hover:scale-105">
                Load
            </button>
            
            <button id="btn-prev"
                class="px-6 py-3 bg-white text-gray-700 border border-gray-300 text-lg font-semibold rounded-lg hover:bg-gray-50 transition shadow-md transform hover:scale-105">
                Experimental Data
            </button>

            <button id="btn-results"
                class="px-6 py-3 bg-white text-gray-700 border border-gray-300 text-lg font-semibold rounded-lg hover:bg-gray-50 transition shadow-md transform hover:scale-105">
                Results
            </button>

            <button id="btn-info"
                class="px-6 py-3 bg-white text-gray-700 border border-gray-300 text-lg font-semibold rounded-lg hover:bg-gray-50 transition shadow-md transform hover:scale-105">
                Info
            </button>
            
            <button id="btn-who"
                class="px-6 py-3 bg-white text-gray-700 border border-gray-300 text-lg font-semibold rounded-lg hover:bg-gray-50 transition shadow-md transform hover:scale-105">
                Who We Are?
            </button>
        </div>
    </div>

    <script>
        // --- 3D Object Setup ---
        let scene, camera, renderer, mesh, controls;

        function init3D() {
            const container = document.getElementById('landing-container');
            scene = new THREE.Scene();
            
            // --- CHANGE: Match scene background to light-mode page (bg-gray-100 = #F3F4F6) ---
            scene.background = new THREE.Color(0xF3F4F6);

            camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.z = 3;
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            // --- CHANGE: Lights adjusted for a light background (slightly softer) ---
            const ambientLight = new THREE.AmbientLight(0xffffff, 3);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 3.0);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);
            const backLight = new THREE.DirectionalLight(0xffffff, 3);
            backLight.position.set(-5, -5, -5);
            scene.add(backLight);

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.autoRotate = true;
            controls.autoRotateSpeed = 4;
            controls.enableDamping = true;
            controls.dampingFactor = 0.1;
            controls.enableZoom = false;
            controls.enablePan = false;
            controls.target.set(0, 0, 0);
            
            const loader = new THREE.GLTFLoader();
            loader.load('/static/Logo_Metu.glb', (gltf) => {
                mesh = gltf.scene;
                const box = new THREE.Box3().setFromObject(mesh);
                const center = box.getCenter(new THREE.Vector3());
                const size = box.getSize(new THREE.Vector3()).length();
                const scale = 4.0 / size;
                mesh.scale.set(scale, scale, scale);
                mesh.position.sub(center.multiplyScalar(scale));
                scene.add(mesh);
            },
            undefined,
            (error) => {
                console.error('An error happened while loading the model:', error);
                const geometry = new THREE.IcosahedronGeometry(1, 0);
                const material = new THREE.MeshPhongMaterial({ color: 0x3f729b });
                mesh = new THREE.Mesh(geometry, material);
                scene.add(mesh);
            });
            window.addEventListener('resize', onWindowResize, false);
            animate();
        }

        function onWindowResize() {
            const container = document.getElementById('landing-container');
            if (!container) return;
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            if (controls) {
                controls.update();
            }
            renderer.render(scene, camera);
        }

        // --- Button and Modal Logic (REFACTORED) ---
        document.addEventListener('DOMContentLoaded', () => {
            init3D();

            // --- NEW: Modal control functions ---
            function openModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('modal-open');
                }
            }

            // --- Button references ---
            const loadBtn = document.getElementById('btn-load');
            const infoBtn = document.getElementById('btn-info');
            const prevBtn = document.getElementById('btn-prev');
            const resultsBtn = document.getElementById('btn-results');
            const whoBtn = document.getElementById('btn-who'); // New button

            // "Load" button
            loadBtn.addEventListener('click', () => {
                window.location.href = '/viewer';
            });
            
            // "Previous Data" button
            prevBtn.addEventListener('click', () => {
                window.location.href = '/data';
            });

            // "Results" button
            resultsBtn.addEventListener('click', () => {
                window.location.href = '/results';
            });
            
            // "Info" button
            infoBtn.addEventListener('click', () => openModal('modal-info'));

            // "Who We Are" button
            whoBtn.addEventListener('click', () => openModal('modal-who'));

            // --- NEW: Add close listeners for ALL modals ---
            document.querySelectorAll('.modal-close-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const modal = btn.closest('.modal-overlay');
                    if(modal) modal.classList.remove('modal-open');
                });
            });

            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        overlay.classList.remove('modal-open');
                    }
                });
            });
        });

    </script>
</body>

</html>